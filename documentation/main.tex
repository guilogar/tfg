\documentclass[a4paper, 11pt, dvipsnames]{book}
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{xcolor}
\usepackage{float}
\usepackage[hidelinks]{hyperref}
\usepackage[all]{hypcap}
\usepackage{bookmark}
\usepackage{graphicx}
\usepackage{emptypage}
\usepackage{eurosym}
\usepackage{geometry}
\usepackage[autopunct]{csquotes}
\usepackage{ragged2e}
\usepackage{longtable,tabularx,ltxtable,array}
\usepackage{multirow}
\usepackage{fancyhdr}
\usepackage{spreadtab}
\usepackage{fp}
\usepackage{changepage}
\usepackage{epigraph}
\usepackage{array}
\usepackage{lscape}
\usepackage{makecell}
\usepackage{enumitem}
\usepackage{svg}
\usepackage{amsmath}
\usepackage[Sonny]{fncychap}
\usepackage{nameref}
\usepackage{listings}
\usepackage{tocbibind}
\usepackage{tocloft}
\usepackage[bottom]{footmisc}
\usepackage[backend=biber]{biblatex}
\addbibresource{sample.bib}
\usepackage{booktabs}
\newcommand\YAMLcolonstyle{\color{red}\mdseries}
\newcommand\YAMLkeystyle{\color{black}\bfseries}
\newcommand\YAMLvaluestyle{\color{blue}\mdseries}

\makeatletter

\newcommand\language@yaml{yaml}

\expandafter\expandafter\expandafter\lstdefinelanguage
\expandafter{\language@yaml}
{
  keywords={true,false,null,y,n},
  keywordstyle=\color{darkgray}\bfseries,
  basicstyle=\YAMLkeystyle,
  sensitive=false,
  comment=[l]{\#},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{purple}\ttfamily,
  stringstyle=\YAMLvaluestyle\ttfamily,
  moredelim=[l][\color{orange}]{\&},
  moredelim=[l][\color{magenta}]{*},
  moredelim=**[il][\YAMLcolonstyle{:}\YAMLvaluestyle]{:},
  morestring=[b]',
  morestring=[b]",
  literate =    {---}{{\ProcessThreeDashes}}3
                {>}{{\textcolor{red}\textgreater}}1
                {|}{{\textcolor{red}\textbar}}1
                {\ -\ }{{\mdseries\ -\ }}3,
}

\lst@AddToHook{EveryLine}{\ifx\lst@language\language@yaml\YAMLkeystyle\fi}
\makeatother

\newcommand\ProcessThreeDashes{\llap{\color{cyan}\mdseries-{-}-}}

\renewcommand{\epigraphflush}{center}
\setlength{\epigraphwidth}{10cm}

\renewcommand{\cellalign}{\theadalign{cl}}
\renewcommand\theadfont{\bfseries}
\renewcommand\theadgape{\Gape[2pt]}
\renewcommand\cellgape{\Gape[2pt]}

\newcommand{\vsep}{\hfil\kern\arraycolsep\vline\kern-\arraycolsep\hfilneg}
\newcommand{\blankpage}
{
    \checkoddpage{}
    \ifoddpage{\newpage}{} \fi
    \cleardoublepage{}
    \thispagestyle{empty}
    \newpage
}

\newcommand{\DNI}{.........}
\newcommand{\autor}{Guillermo López García}
\newcommand{\director}{Guadalupe Ortiz}
\newcommand{\codirector}{David Corral}
\newcommand{\proyecto}{Smart Rural}
\newcommand{\nombre}{Acrónimo proyecto}
\newcommand{\tipo}{Grado}
\newcommand{\titulo}{Ingeniería Informática}
\newcommand{\titulacion}{\tipo{} en \titulo}
\newcommand{\dia}{15}
\newcommand{\mes}{junio}
\newcommand{\anno}{2021}
\newcommand{\fecha}{\mes{} \anno}
\newcommand{\Fecha}{\dia{} de \mes{} de \anno}

\newcommand{\lorem}
{

}

\fancypagestyle{plain}
{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
}

\fancypagestyle{prefacepage}
{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \fancyfoot[RE,LO]{\textsl{\thepage}}

}

\fancypagestyle{chapterpage}
{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \fancyfoot[RE,LO]{}
}

\setlength{\headheight}{15pt}
\fancyhead[LO]{\textbf{\textsl{\leftmark}}}
\fancyhead[LE]{\textbf{\textsl{\thepage}}}
\fancyhead[RO]{\textbf{\textsl{\thepage}}}
\fancyhead[RE]{\textbf{\textsl{\rightmark}}}
\fancyhead[C]{}

\fancyfoot[LE,RO]{}
\fancyfoot[LO,RE]{}
\fancyfoot[RE,LO]{}
\fancyfoot[RO,LE]{}
\fancyfoot[C]{}

\newenvironment{portada}
{
    \newgeometry{left=2cm,right=2cm,top=2cm,bottom=1cm}
    \includegraphics[width=7cm, keepaspectratio]{images/UCA.jpg}  \\ \vspace{1cm}
    \begin{center}
}
{
    \end{center}
    \restoregeometry{}
}

\newcommand\addrow[2]{#1 &#2\\ }

\newcommand\addheading[2]{#1 &#2\\ \hline}
\newcommand\tabularhead{\begin{tabular}{lp{8cm}}
\hline
}

\newcommand\addmulrow[2]{ \begin{minipage}[t][][t]{2.5cm}#1\end{minipage}%
   &\begin{minipage}[t][][t]{8cm}
    \begin{enumerate} #2   \end{enumerate}
    \end{minipage}\\ }

\newenvironment{usecase}{\tabularhead}
{\hline\end{tabular}}

\begin{document}
    \begin{titlepage}
        \newgeometry{left=2cm,right=2cm,top=2cm,bottom=1cm}
        \includegraphics[width=7cm, keepaspectratio]{images/UCA.jpg}  \\ \vspace{1cm}
        \begin{center}
            \Large \MakeUppercase{Trabajo de Fin de Grado} \\ \vspace{1cm}
            \Large \MakeUppercase{\titulacion} \\ \vspace{6cm}
            \LARGE \MakeUppercase{\textbf{\proyecto}} \\ \vspace{7cm}
            \Large \MakeUppercase{Autor: \autor} \\ \vspace{0.5cm}
            Puerto Real, \fecha{}
        \end{center}
        \restoregeometry{}
    \end{titlepage}

    \blankpage{}

    \begin{portada}
        \Large \MakeUppercase{Trabajo de Fin de Grado} \\ \vspace{1cm}
        \Large \MakeUppercase{\titulacion} \\ \vspace{6cm}
        \LARGE \MakeUppercase{\textbf{\proyecto}} \\ \vspace{7cm}
        \Large \MakeUppercase{Director: \director} \\
        \Large \MakeUppercase{Autor: \autor} \\ \vspace{0.5cm}
        Puerto Real, \fecha{}
    \end{portada}

    \blankpage{}
    \pagenumbering{arabic}
    \pagestyle{fancy}
    \input{cover-page/signature.tex}

    \input{cover-page/preface.tex}

    \blankpage

    \tableofcontents
    \chapter{Introducción}
    \section{Ámbito}
    \section{Motivación}
    \section{Objetivos}
    \section{Alcance}
    \section{Estructura de la memoria}
    \section{Glosario}
    \chapter{Conceptos preliminares y estado del arte}
    \chapter{Planificación}
    \section{Investigación previa}
    \section{Enfoque metodológico}
    \section{Planificación del proyecto}
    \section{Diagrama Gantt}
    \chapter{Análisis}
    \section{Catálogo de actores}
    \section{Requisitos funcionales}
    \section{Requisitos no funcionales}
    \section{Descripción de los casos de uso}
    \chapter{Diseño}
    \section{Arquitectura lógica}
    \section{Modelo Relacional}
    \section{Diseño de la interfaz}
    \chapter{Implementación}
    \chapter{Pruebas}
    \chapter{Manual de Instalación}
    \chapter{Manual de Usuario}

    \chapter{Conclusiones}
    \begin{thebibliography}{9}
    \bibitem{texbook}
    NodeJS, \url{https://nodejs.org/es/}
    \end{thebibliography}
\end{document}
